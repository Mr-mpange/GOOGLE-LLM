{
  "name": "Error Rate Increase",
  "type": "metric alert",
  "isEnabled": true,
  "queries": [
    {
      "query": "avg(last_10m):sum:llm.error.count{*}.as_rate()",
      "aggregation": "sum",
      "groupByFields": ["error_type", "endpoint"],
      "metric": "llm.error.count"
    }
  ],
  "cases": [
    {
      "status": "critical",
      "condition": "a > 10",
      "name": "Critical error rate",
      "notifications": [
        "@slack-alerts",
        "@pagerduty",
        "@email-oncall"
      ]
    },
    {
      "status": "warning",
      "condition": "a > 5",
      "name": "Elevated error rate",
      "notifications": [
        "@slack-alerts"
      ]
    }
  ],
  "options": {
    "evaluationWindow": 600,
    "thresholds": {
      "critical": 10,
      "warning": 5
    },
    "notifyNoData": false,
    "requireFullWindow": false,
    "notifyAudit": true,
    "includeTags": true
  },
  "message": "## Error Rate Increase Detected\n\n**Severity:** {{#is_alert}}Critical{{/is_alert}}{{#is_warning}}Warning{{/is_warning}}\n\n**Current Error Rate:** {{value}} errors/min\n**Threshold:** {{threshold}} errors/min\n\n**Error Type:** {{error_type}}\n**Endpoint:** {{endpoint}}\n\n**Common Error Types:**\n- `VertexAIError`: Vertex AI API issues\n- `AuthenticationError`: API key problems\n- `RateLimitError`: Quota exceeded\n- `ValidationError`: Invalid input\n- `TimeoutError`: Request timeout\n\n**Action Required:**\n1. Check error logs for patterns\n2. Verify Vertex AI API status\n3. Review recent deployments\n4. Check API quotas and limits\n5. Investigate network connectivity\n\n**Recent Errors:** [View in Datadog](https://app.datadoghq.com/logs?query=status:error%20service:llm-guardian)\n\n**Dashboard:** [View Performance Dashboard](https://app.datadoghq.com/dashboard/llm-performance)\n\n**Runbook:** https://docs.company.com/runbooks/error-rate-increase",
  "tags": [
    "alert:error-rate",
    "service:llm-guardian",
    "team:platform",
    "priority:high"
  ]
}
