{
  "title": "LLM Guardian - Security Dashboard",
  "description": "Security monitoring for LLM application including threat detection, blocked prompts, and policy violations",
  "widgets": [
    {
      "id": 1,
      "definition": {
        "type": "query_value",
        "requests": [
          {
            "q": "sum:llm.security.injection_blocked{*}.as_count()",
            "aggregator": "sum"
          }
        ],
        "title": "Blocked Prompts (24h)",
        "precision": 0,
        "custom_unit": "blocks"
      }
    },
    {
      "id": 2,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "sum:llm.security.signal{*}.as_count() by {severity}",
            "display_type": "bars"
          }
        ],
        "title": "Security Signals by Severity",
        "show_legend": true
      }
    },
    {
      "id": 3,
      "definition": {
        "type": "event_stream",
        "query": "tags:security:true",
        "title": "Security Events Stream",
        "event_size": "l"
      }
    },
    {
      "id": 4,
      "definition": {
        "type": "toplist",
        "requests": [
          {
            "q": "top(sum:llm.security.injection_blocked{*} by {user}, 10, 'sum', 'desc')"
          }
        ],
        "title": "Top Users with Blocked Prompts"
      }
    },
    {
      "id": 5,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "sum:llm.security.signal{severity:high}.as_count()",
            "display_type": "bars",
            "style": {
              "palette": "warm"
            }
          }
        ],
        "title": "High Severity Security Alerts",
        "show_legend": false
      }
    },
    {
      "id": 6,
      "definition": {
        "type": "query_table",
        "requests": [
          {
            "q": "sum:llm.security.injection_blocked{*} by {user,session}",
            "aggregator": "sum",
            "limit": 50
          }
        ],
        "title": "Suspicious User Activity"
      }
    },
    {
      "id": 7,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:llm.safety.score{*}",
            "display_type": "line"
          }
        ],
        "title": "Safety Score Trend",
        "show_legend": false,
        "markers": [
          {
            "value": "y = 0.5",
            "display_type": "error dashed"
          }
        ]
      }
    },
    {
      "id": 8,
      "definition": {
        "type": "heatmap",
        "requests": [
          {
            "q": "avg:llm.safety.score{*} by {user}"
          }
        ],
        "title": "Safety Score by User"
      }
    },
    {
      "id": 9,
      "definition": {
        "type": "sunburst",
        "requests": [
          {
            "q": "sum:llm.security.signal{*} by {severity,tags}"
          }
        ],
        "title": "Security Signal Distribution"
      }
    },
    {
      "id": 10,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "anomalies(avg:llm.request.count{*}, 'basic', 2)",
            "display_type": "line"
          }
        ],
        "title": "Anomalous Request Patterns",
        "show_legend": true
      }
    }
  ],
  "layout_type": "ordered",
  "is_read_only": false,
  "notify_list": [],
  "template_variables": [
    {
      "name": "env",
      "default": "production",
      "prefix": "env"
    },
    {
      "name": "severity",
      "default": "*",
      "prefix": "severity"
    }
  ]
}
